(window.__LOADABLE_LOADED_CHUNKS__=window.__LOADABLE_LOADED_CHUNKS__||[]).push([["HarbergerTaxBannerPurchaseCTA"],{"./src/reddit/actions/harbergerTax/actionCreators.ts":function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"e",(function(){return i})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"f",(function(){return u})),n.d(t,"g",(function(){return l})),n.d(t,"h",(function(){return b})),n.d(t,"i",(function(){return f})),n.d(t,"j",(function(){return m}));var r=n("./src/lib/makeActionCreator/index.ts"),s=n("./src/reddit/actions/harbergerTax/constants.ts");const o=Object(r.a)(s.c),i=Object(r.a)(s.e),d=Object(r.a)(s.a),c=Object(r.a)(s.b),a=Object(r.a)(s.d),u=Object(r.a)(s.f),l=Object(r.a)(s.g),b=Object(r.a)(s.h),f=Object(r.a)(s.i),m=Object(r.a)(s.j)},"./src/reddit/components/Governance/HarbergerTax/BannerPurchaseCTA/index.m.less":function(e,t,n){e.exports={container:"oc2hBUbsTl-V_W2CPEsZf",disabled:"_2fJJUTzj7dLnv_DNuenZP9",token:"_3w6edM8masZLL2X9YoWf0A"}},"./src/reddit/components/Governance/HarbergerTax/BannerPurchaseCTA/index.tsx":function(e,t,n){"use strict";n.r(t);var r=n("./node_modules/fbt/lib/FbtPublic.js"),s=n("./node_modules/react/index.js"),o=n.n(s),i=n("./node_modules/react-redux/es/index.js"),d=n("./node_modules/reselect/es/index.js"),c=n("./src/lib/classNames/index.ts"),a=n("./src/lib/prettyPrintNumber/index.ts"),u=n("./src/reddit/actions/harbergerTax/actionCreators.ts"),l=n("./src/reddit/actions/tooltip.ts"),b=n("./src/reddit/components/Governance/Token/index.tsx"),f=n("./src/reddit/components/InfoTextTooltip/index.tsx"),m=n("./src/reddit/contexts/PageLayer/index.tsx"),p=n("./src/reddit/featureFlags/component.tsx"),v=n("./src/reddit/helpers/governance/ethereum.ts"),h=n("./src/reddit/helpers/governance/tokens.ts"),g=n("./src/reddit/selectors/crypto/points.ts"),j=n("./src/reddit/selectors/crypto/wallet.ts"),x=n("./src/reddit/selectors/experiments/econ/index.ts"),w=n("./src/reddit/selectors/gov.ts"),O=n("./src/reddit/components/Governance/HarbergerTax/BannerPurchaseCTA/index.m.less"),y=n.n(O);const _=Object(d.c)({cost:(e,t)=>{const n=Object(m.s)(e,t);if(n)return Object(w.b)(e,{subredditId:n.id})},pointsDetails:(e,t)=>{const n=Object(m.s)(e,t);return Object(g.b)(e,null==n?void 0:n.id)},publicAddress:(e,t)=>{const n=Object(m.s)(e,t);return(null==n?void 0:n.id)?Object(j.b)(e,{subredditId:null==n?void 0:n.id}):void 0},subreddit:m.s,userOwnsBanner:(e,t)=>{const n=Object(m.s)(e,t),r=e.user.account;if(n&&r){return Object(w.c)(e,{subredditId:n.id}).ownerId===r.id}return!1},pointsSunsetEnabled:x.i}),T=Object(i.b)(_,e=>({onHideTooltip:()=>e(Object(l.i)()),onOpenManageFlow:(t,n)=>e(n?Object(u.a)({subredditId:t}):Object(u.c)({subredditId:t})),onOpenPurchaseFlow:(t,n)=>e(n?Object(u.b)({subredditId:t}):Object(u.e)({subredditId:t})),onShowTooltip:t=>e(Object(l.f)({tooltipId:t}))})),k=Object(m.v)();t.default=Object(p.a)("spHarberger",k(T((function(e){const{cost:t,publicAddress:n,subreddit:i,userOwnsBanner:d,onHideTooltip:u,onOpenManageFlow:l,onOpenPurchaseFlow:m,onShowTooltip:p,pointsDetails:g,pointsSunsetEnabled:j}=e;if(!t||!g||!i||j)return null;const x=Object(v.e)(),w=!d&&(!x||!!!n||g.inTransition),O=`harberger-cta-${i.id}`;return o.a.createElement("div",{className:Object(c.a)(y.a.container,{[y.a.disabled]:w}),id:O,onClick:()=>{if(w)return;const e=!!g.blockchainProvider;d?l(i.id,e):m(i.id,e)},onMouseOver:()=>p(O),onMouseOut:u},d?r.fbt._("Manage Banner",null,{hk:"aHDWM"}):o.a.createElement(s.Fragment,null,r.fbt._("Buy Banner",null,{hk:"3Mp8CG"}),o.a.createElement(b.a,{className:y.a.token,subredditId:i.id}),Object(a.a)(Object(h.c)(t,g.displayConversion))),w&&o.a.createElement(f.c,{tooltipId:O,text:x?r.fbt._("You must register your wallet address to purchase the banner",null,{hk:"38o58h"}):r.fbt._("You must have metamask installed to purchase the banner",null,{hk:"3A896M"})}))}))))},"./src/reddit/components/Governance/Token/index.m.less":function(e,t,n){e.exports={grey:"_3oUx7R2UEz3llZLsIONH4x"}},"./src/reddit/components/Governance/Token/index.tsx":function(e,t,n){"use strict";var r=n("./node_modules/react/index.js"),s=n.n(r),o=n("./node_modules/react-redux/es/index.js"),i=n("./node_modules/reselect/es/index.js"),d=n("./src/config.ts"),c=n("./src/lib/classNames/index.ts"),a=n("./src/reddit/selectors/crypto/points.ts"),u=n("./src/reddit/components/Governance/Token/index.m.less"),l=n.n(u);const b=Object(i.c)({pointsDetails:(e,t)=>{let{subredditId:n}=t;return Object(a.b)(e,n)}});t.a=Object(o.b)(b)((function(e){var t;const n=null===(t=e.pointsDetails)||void 0===t?void 0:t.images;if(!n)return null;const r=e.grey?n.greyVector||n.grey:n.filledVector||n.filled,o=`${d.a.assetPath}/${r}`;if(e.grey&&o.endsWith(".svg")){const t=`url(${o}) center/cover`;return s.a.createElement("div",{className:Object(c.a)(l.a.grey,e.className),style:{mask:t,WebkitMask:t}})}return s.a.createElement("img",{className:e.className,src:o})}))},"./src/reddit/helpers/governance/ethereum.ts":function(e,t,n){"use strict";n.d(t,"e",(function(){return o})),n.d(t,"c",(function(){return i})),n.d(t,"d",(function(){return d})),n.d(t,"b",(function(){return c})),n.d(t,"a",(function(){return a})),n.d(t,"f",(function(){return f})),n.d(t,"g",(function(){return m})),n.d(t,"h",(function(){return p}));n("./node_modules/core-js/modules/web.dom.iterable.js");var r=n("./node_modules/fbt/lib/FbtPublic.js");function s(){return window.ethereum}function o(){const e=s();return!(!e||!e.isMetaMask)}function i(){const e=s();return e&&e.selectedAddress||null}function d(){const e=s();return(null==e?void 0:e.networkVersion)||null}function c(){const e=s();if(!e)throw new Error("Please install a web3 provider, such as MetaMask");return i()?Promise.resolve():e.enable()}const a=4001;const u={abi:[{constant:!1,inputs:[{name:"to",type:"address"},{name:"value",type:"uint256"},{name:"data",type:"bytes"}],name:"send",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"}]};async function l(e,t,r,o){return async function(e,t,r,o){const[i,d]=await Promise.all([n.e("vendors~Avatar~CollectiblesShowcaseUnit~CryptoLibEthers~GovernanceTransferPointsModal~MarketplaceCla~fa3a0eb0").then(n.bind(null,"./node_modules/ethers/lib.esm/index.js")).then(e=>e.ethers),t.then(e=>e.abi)]);await c();const a=new i.providers.Web3Provider(s()).getSigner(),u=new i.Contract(e,d,a),l=await u[r](...o);return await l.wait()}(e,Promise.resolve(u),"send",[t,r,o])}const b=1;async function f(e,t,r,s,o){const i=await n.e("vendors~Avatar~CollectiblesShowcaseUnit~CryptoLibEthers~GovernanceTransferPointsModal~MarketplaceCla~fa3a0eb0").then(n.bind(null,"./node_modules/ethers/lib.esm/index.js")).then(e=>e.ethers),{BigNumber:d}=i,{hexlify:c,hexZeroPad:a,toUtf8Bytes:u}=i.utils,f=d.from(r).add(o),m=b,p="0x"+[c(1)].concat([c(m),d.from(s).toHexString(),d.from(o).toHexString()].map(e=>a(e,32))).concat(c(u(""))).map(e=>e.substr(2)).join("");return l(e,t,f.toString(),p)}function m(e){const t=s();return new Promise((n,s)=>{const o=JSON.stringify(e);t.sendAsync({method:"eth_signTypedData_v3",params:[t.selectedAddress,o],from:t.selectedAddress},(e,t)=>{if(e)s(e);else{const e=t&&t.result;e?n(e):s({message:r.fbt._("No signature returned from ethereum provider.",null,{hk:"eiYBF"}).toString()})}})})}function p(e){return new Promise((t,n)=>{s().sendAsync({method:"metamask_watchAsset",params:{type:"ERC20",options:e},id:Math.round(1e5*Math.random())},(e,r)=>{e||"error"in r?n("There was an error tracking the token"):t()})})}},"./src/reddit/helpers/governance/tokens.ts":function(e,t,n){"use strict";n.d(t,"c",(function(){return o})),n.d(t,"d",(function(){return i})),n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return c}));var r=n("./node_modules/bignumber.js/bignumber.js"),s=n("./src/lib/prettyPrintNumber/index.ts");function o(e,t){const n=new r.BigNumber(e),s=new r.BigNumber(t||1);return n.dividedToIntegerBy(s).toString()}function i(e,t){return Object(s.b)(parseInt(o(e,t),10))}function d(e,t){const n=new r.BigNumber(e),s=new r.BigNumber(t||1);return n.multipliedBy(s).toFixed(0)}function c(e){const t=new r.BigNumber(e),n=new r.BigNumber("1e18");return t.dividedBy(n).toString()}},"./src/reddit/selectors/crypto/wallet.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return o})),n.d(t,"b",(function(){return i})),n.d(t,"c",(function(){return d}));var r=n("./src/lib/initializeClient/installReducer.ts"),s=n("./src/reddit/reducers/features/crypto/index.ts");Object(r.a)({features:{crypto:s.a}});const o=(e,t)=>{var n;return t&&(null===(n=e.user.wallets[t.subredditId])||void 0===n?void 0:n.latest)},i=(e,t)=>{var n;return null===(n=o(e,t))||void 0===n?void 0:n.publicAddress},d=(e,t)=>{var n,r,s,o;return null===(o=null===(s=null===(r=null===(n=e.features)||void 0===n?void 0:n.crypto)||void 0===r?void 0:r.publicWallets)||void 0===s?void 0:s[t.userId])||void 0===o?void 0:o[t.subredditId]}},"./src/reddit/selectors/gov.ts":function(e,t,n){"use strict";n.d(t,"a",(function(){return i})),n.d(t,"b",(function(){return d})),n.d(t,"c",(function(){return c})),n.d(t,"d",(function(){return a})),n.d(t,"g",(function(){return u})),n.d(t,"e",(function(){return l})),n.d(t,"f",(function(){return b}));var r=n("./src/reddit/contexts/PageLayer/index.tsx");const s=[],o={},i=(e,t)=>{const n=f(e,t);if(n)return n.mainHeader},d=(e,t)=>{const n=f(e,t);return n&&n.mainHeader?n.mainHeader.price:"0"},c=(e,t)=>{const n=f(e,t);return n&&n.mainHeader?{owner:n.mainHeader.owner,ownerId:n.mainHeader.ownerId}:o},a=(e,t)=>t&&t.subredditId?(e.user.wallets[t.subredditId]||{}).latest:void 0,u=(e,t)=>{const n=a(e,t),r=n&&n.publicAddress;if(!r)throw new Error("No wallet address found");return r},l=(e,t)=>{const n=a(e,t);return n&&n.amount||"0"},b=(e,t)=>{const n=Object(r.o)(e,t);return n&&e.subreddits.gov.releaseNotes[n]||s},f=(e,t)=>t.subredditId?e.subreddits.gov.assets[t.subredditId]:void 0}}]);
//# sourceMappingURL=https://www.redditstatic.com/desktop2x/HarbergerTaxBannerPurchaseCTA.78009f79d68ba9e854c0.js.map